# アプリ全体 UI/UX 大胆リデザイン案（スタイリッシュ / プロフェッショナル / 直感的）

作成日: 2025-12-26  
対象: `pdf-viewer` 全体（`src/app/pages/viewer-shell/*` を中心に、ダイアログ/パネル/メニュー含む）

関連ドキュメント:
- 複数PDFライブラリ（`docs/multi-pdf-library-design.md`）
- ページジャンプ（`docs/page-jump-design.md`）
- コメントUI/UX（`docs/comment-uiux-redesign.md`）

---

## 0. 北極星（North Star）
「PDFレビュー作業を“ワークスペース化”し、迷わず・速く・気持ちよく操作できる」ことを最優先にする。

キーワード:
- **Clarity**: 情報の階層と余白で“迷い”を消す
- **Speed**: 主要操作は 1-2 クリック / 1 ショートカットで完了
- **Confidence**: 状態が常に見える（今何を見ている/何が有効か）
- **Craft**: 文字・影・境界・モーションの統一で“プロ感”を作る

---

## 1. デザインの方向性（3案 → 推奨）
### A案: **Midnight Studio（ダーク基調 + 高級感）** ※推奨
- ダーク背景に「低彩度の面 + 透明感 + 控えめな発光」を重ねて、集中できる閲覧体験に寄せる。
- 既存のダーク基調を活かしつつ、**面の階層**と**余白規律**を強化して“洗練”に寄せる。

### B案: Paper Pro（ライト基調 + 書類感）
- “紙”のメタファーを強め、PDFキャンバスを主役にする。業務アプリの信頼感が出やすい。
- 反面、暗所や長時間作業では疲れやすいので **ダーク切替必須**。

### C案: Carbon Minimal（超ミニマル + ツールは必要時のみ）
- 画面常駐UIを減らし、ホバー/選択時にのみツールを出す。
- 学習コストが上がりやすいので、初期は A案に寄せ、段階導入が安全。

このドキュメントでは A案（Midnight Studio）を前提に具体案を整理する。

---

## 2. 情報設計（IA）: 「常に3つのゾーン」
1) **Command（指令）**: 何ができるか（上部コマンドバー）  
2) **Canvas（作業）**: PDFそのもの（中央）  
3) **Inspector（詳細）**: 選択対象の情報・一覧（右/左のドック）

基本レイアウト（ワイヤー）:
```
┌────────────────────────── Command Bar ──────────────────────────┐
│ [Import] [Library] [Search] [OCR] [Compare]        Doc / Page / │
│                                                   Zoom / Status │
└─────────────────────────────────────────────────────────────────┘
┌──── Left Dock ────┬────────────────── Canvas ───────────────────┬─ Right Dock ─┐
│ Library/Thumbs    │  PDF pages / selection / overlays           │ Inspector    │
│ (tab switch)      │                                             │ (tab switch) │
└───────────────────┴─────────────────────────────────────────────┴──────────────┘
```

原則:
- 画面を **「中央=作業」**に振り切る（サイドは折りたたみ/幅可変）。
- 一覧は「探す」、詳細は「編集する」で役割を分ける（同じ情報を2ヶ所に出さない）。

---

## 3. 主要画面・コンポーネント案
### 3.1 Command Bar（上部）
**目的**: 主要アクションを一箇所に集約し、状態（doc/page/zoom/loading/error）を自然に見せる。

提案:
- 左: `Import`（ファイル選択 + D&Dの説明/導線）、`Library`（複数PDF）、`Search`（検索）、`OCR`、`Compare`
- 中央: **ドキュメント名**（長い場合は省略 + tooltip）
- 右: **ページジャンプ**（`1 / 120` + 入力）、ズーム、`Objects` ON/OFF、`Download`
- 追加（検討）: `Ctrl/Cmd + K` の **Command Palette**（検索・移動・切替を一つに）

UIルール:
- 「有効/無効」を色だけで表さず、disabled/opacity/tooltip を併用
- グループ単位で余白と区切りを統一（セグメント/ディバイダ）

### 3.2 Left Dock（左）
タブで切替（最初は2つで十分）:
- **Library**: 複数PDFのカード/リスト（`docs/multi-pdf-library-design.md` と統合）
- **Thumbnails**: 現在PDFのサムネ（ページ移動の最短動線）

設計ポイント:
- どちらも「高密度表示」を基本にして、作業領域を侵食しない
- 右利き前提でも、頻出操作（ページ移動）を左に置くことで視線移動が短くなる

### 3.3 Right Dock（右）
タブで切替:
- **Inspector**: 選択中のハイライト/コメントの詳細と編集（タイトル、色、削除、返信など）
- **Lists**: コメント一覧 / ハイライト一覧（ページセクション化などは `docs/comment-uiux-redesign.md` を踏襲）
- **Compare**: 比較結果の要約・差分一覧（ページ単位のジャンプ）

設計ポイント:
- 「右は編集・詳細、左は移動・一覧」に寄せると混乱が減る
- 空状態は“次の一手”を出す（例: 「テキスト選択 → 右クリックでハイライト」）

---

## 4. ビジュアルシステム（Design Tokens）
### 4.1 ベース（面/境界/影）
狙い: 境界線だらけのUIではなく、**面の階層**で整理する（プロ感が出る）。

推奨トークン（例）:
- 背景: `bg-0`（最背面）
- 面: `surface-1/2/3`（カード/パネル/ポップオーバー）
- 境界: `border-subtle`（通常）、`border-strong`（フォーカス/選択）
- 影: `shadow-1/2/3`（浮き具合の統一）

### 4.2 タイポグラフィ
- フォント: `Inter` を継続（読みやすく、プロダクト感が出る）
- 文字サイズは用途別に固定し、増やしすぎない（例: 11/12/14/16）
- 数値・ショートカット・ラベルは `tracking` を整える（情報密度を上げても読める）

### 4.3 カラー（アクセント運用）
- アクセントは **1色系**（例: Indigo/Violet）に絞る  
  - “何でもカラフル”にすると業務感が落ちる
- 例外として、注釈（ハイライト色）は複数色を許可（意味があるため）
- エラー/警告/成功はシステム色で統一（赤/黄/緑）

---

## 5. インタラクション（直感性のためのルール）
### 5.1 オブジェクト（ハイライト/コメント）
- **クリック**: 選択（Inspector に詳細が出る）
- **ダブルクリック**: 編集（タイトル/本文など）
- **右クリック**: 追加/変換/削除（コンテキストメニュー）
- **Esc**: 選択解除・メニュー閉じる

選択時の表現:
- キャンバス上: 1) 境界強調 2) 影（または発光） 3) Inspector の同期
- リスト上: 1) 背景 2) 左ボーダー 3) 右側にアクション（控えめ）

### 5.2 モードの見せ方（OCR/Compare/Objects）
“機能がONなのか、見えているだけなのか”が混乱ポイントになりやすい。

提案:
- Command Bar に「現在モード」を **常時表示**（例: `Compare: Base vs Target`）
- Viewer には小さなバッジ（押し付けない）で追従

### 5.3 フィードバック（読み込み・処理・失敗）
- 読み込み: スケルトン + “何をしているか”の短いテキスト（例: 「ページ描画中 12/120」）
- 失敗: トースト + 詳細（折りたたみ） + 再試行
- 成功: トーストは最小限（過剰な通知は集中を壊す）

---

## 6. モーション（上質さの源泉）
原則: 速い・短い・控えめ。目的は“理解”であって“演出”ではない。

推奨:
- hover: 120ms
- panel open/close: 160-220ms（ease-out）
- toast: 220ms（in/out）

避ける:
- 大きなバウンス、長いフェード、常時光るアニメーション

---

## 7. アクセシビリティ（プロ用途の前提）
- フォーカスリングは必須（キーボード操作で迷子にしない）
- コントラストは WCAG AA を意識（特にダークテーマの薄い文字）
- 色だけに依存しない（選択/エラーはアイコン・形状・テキストも併用）
- クリック領域は最小 36px を目安（密度と両立するため “余白ではなくヒット領域” を確保）

---

## 8. 実装ロードマップ（安全に大胆に）
### Phase 1: デザイン・トークンの確立（壊さずに効く）
- 色/影/角丸/余白/フォーカスのトークン化（既存 `mixins` と整合）
- ボタン/入力/リスト/ポップオーバーの見た目を統一
- 空状態・エラー・ローディングのパターン統一

### Phase 2: レイアウトの再編（体験を変える）
- Command Bar の情報再配置（ページジャンプ、doc名、処理状態）
- Left/Right Dock（タブ + 折りたたみ + 幅可変）導入
- ライブラリ/サムネ/一覧の“居場所”を確定

### Phase 3: 仕上げ（上質さ）
- モーション/マイクロコピーの調整
- キーボードショートカットの拡充（操作の速さを底上げ）
- 長時間利用で疲れないコントラスト最適化

---

## 9. 受け入れ指標（UXを測る）
最低限、次を満たすと「大胆更新が成功」と言える:
- 初見ユーザーが 1分以内に「読み込み → ページ移動 → 注釈追加」を完了できる
- 主要操作が視線移動少なく完結する（中央作業を邪魔しない）
- 状態が見える（doc/page/zoom/loading/error/mode）
- 画面が“統一されたプロダクト”に見える（境界・余白・色・影・文字の規律）

---

## 10. 未決（このドキュメントを元に決めること）
- デフォルトテーマ: ダーク固定 or ライト/ダーク切替
- 左ドックの第2タブ: サムネ優先か、アウトライン/検索結果を優先か
- Command Palette をMVPに含めるか（効果は高いが設計が要る）

---

## 11. レイアウト仕様（数値・レスポンシブ）
この章は「大胆に変える」時に迷いが出やすい **寸法・縮退ルール** を先に固定する。

### 11.1 ベース寸法（推奨）
- Command Bar 高さ: `64px`（1段）/ `112px`（2段）
- Dock（左右）幅: 既定 `320px` / 最小 `260px` / 最大 `420px`
- Dock 折りたたみ幅（アイコンのみ）: `56px`
- 画面外余白（最外周）: `16px`（`px-4` 相当）
- セクション間余白: `12px`
- クリック領域の最小: `36px`（アイコンボタン/タブ/チップ）

### 11.2 ブレークポイントと縮退
- `>= 1280px`（Desktop）: 左Dock + 右Dock + Canvas の3カラム
- `1024px - 1279px`（Laptop）: Dockは **片側だけ常時表示**（もう片側は折りたたみ or オーバーレイ）
- `< 1024px`（Tablet/Small）: Dockは **オーバーレイ（Drawer）** に切替、Command Bar は2段化

### 11.3 Dockの振る舞い（推奨）
- タブ: 左Dock（Library / Thumbnails）、右Dock（Inspector / Lists / Compare）
- リサイズ: ドラッグで幅変更（min/max を超えない）
- 折りたたみ: `L`/`R` のトグル（ショートカットは 15章参照）
- 状態保持: `localStorage` に「左右の開閉」「幅」「最後に開いたタブ」を保存

### 11.4 Canvas（PDF領域）の優先ルール
- 何よりも **中央の可視領域** を確保する（Dockが開いていてもPDFが窮屈になりすぎない幅を守る）
- `Zen`（集中）モード（任意）: Dockを閉じ、Command Bar を薄くする/自動隠し（Escで戻す）

---

## 12. トークン具体案（既存カラーへのマッピング）
すでに `src/styles/_colors.scss` に色のCSS変数が定義されているため、**新規トークンは「意味（semantic）」中心**にし、既存色へ割り当てる。

### 12.1 Semantic Color（例）
（括弧内は `mixins.color('...')` の候補）
- `bg-0`（最背面）: `ink-950`
- `surface-1`（パネル/入力/カード）: `slate-900`
- `surface-2`（浮いた面/選択状態）: `ink-900` / `ink-800`
- `surface-3`（メニュー/ポップオーバー）: `ink-deep-a92`
- `text-primary`: `steel-100`
- `text-secondary`: `steel-200`
- `text-muted`: `steel-300` / `slate-400-a80`
- `border-subtle`: `slate-400-a20`
- `border-default`: `slate-400-a30`
- `border-strong`（選択/フォーカス）: `blue-600-a50`
- `accent-1`: `blue-600`（グラデ開始）
- `accent-2`: `violet-600`（グラデ終端）
- `danger`: `red-400`
- `warn`: `amber-400`

### 12.2 Radius / Shadow / Space（例）
色以外も「規律」が効くため、値を固定して使い回す。
- Radius: `--radius-sm=10px`, `--radius-md=14px`, `--radius-lg=18px`, `--radius-xl=24px`
- Shadow: `--shadow-1=0 10px 24px black-a35`, `--shadow-2=0 18px 40px black-a45`, `--shadow-3=0 30px 60px black-a50`
- Space: `4/8/12/16/24/32` を基本スケールとして、例外は作らない（密度が欲しい領域は「paddingを減らす」ではなく「表示情報を絞る」）

### 12.3 Focus（既存との整合）
- フォーカスリングは既存の `mixins.focus-ring(mixins.color('blue-300'))` を正とし、全操作要素へ適用する

---

## 13. コンポーネント仕様（UIパーツ詳細）
ここは実装に直結する「見た目と状態」の定義。

### 13.1 ボタン
- Primary: グラデ（`blue-600`→`violet-600`）、文字は白、hoverで影 `shadow-1`
- Secondary/Ghost: 背景透明、hoverで `slate-900-a60`、選択時は `blue-600-a16` + `blue-200`
- Destructive: ghostベース + `red-400`（文字/枠）
- IconButton: `36px` 正方、`aria-label` 必須、ツールチップ推奨

状態:
- disabled: `opacity: 0.6` + `cursor: not-allowed`（色だけで判断させない）
- focus-visible: 全ボタン共通でリング

### 13.2 入力（検索/数値/セレクト）
- 高さは原則 `36px`（密度が必要なら `32px` の compact を用意）
- Prefix/Suffix（任意）: アイコンや `1 / 120` のような補助表示を“内側”に持つ（レイアウト崩れ防止）
- 数値入力: 直接編集できるが、確定値はクランプ（`docs/page-jump-design.md` の方針）

### 13.3 Dockタブ
- 左寄せ縦タブ（推奨） or Dock上部横タブ（現実装に合わせて選択）
- 選択状態は「左ボーダー + 面 + 文字色」で示す（色だけに依存しない）

### 13.4 リスト（高密度）
- 1行は「タイトル中心 + 右端に最小アクション」
- 長文は出さない（全文は Inspector か hover/tooltip）
- ページ単位セクション化（コメント/ハイライト/比較結果）: `docs/comment-uiux-redesign.md` の思想を全一覧に拡張

### 13.5 トースト / ダイアログ / ポップオーバー
- Toast: 右上（Command Barの直下）/ 220ms で出入り、重要度で色を変える
- Dialog: ライブラリ一覧など“モード切替”はDialogよりDock優先（Dialogは「大量選択/管理」用途に限定）
- Popover: コンテキストメニュー、Command Palette、ショートカット一覧

---

## 14. 機能別 UI/UX 詳細（MVP想定）
### 14.1 起動直後（空状態）
Canvas:
- 主文: 「PDFを追加して開始」
- 補助: 「ドラッグ&ドロップまたは［PDFを追加］」
Command Bar:
- Primary CTA を左端に固定（迷わせない）

### 14.2 取り込み（Import）
要点: “追加できた”がすぐ分かり、次の行動（開く/続けて追加）が自然。
- ファイル選択: `PDFを追加`（複数選択可）
- D&D: 画面全面にドロップオーバーレイ（受理可/不可を明示）
- 追加後トースト例:
  - 成功: 「3件をライブラリに追加」［最後に追加したPDFを開く］
  - 失敗: 「読み込めないPDFがありました」［詳細］［再試行］

### 14.3 複数PDFライブラリ（Library）
配置: Left Dock（常時 or すぐ開ける）
- 表示: サムネ（任意/遅延） + `displayName` + ページ数 + 追加時刻（詳細は非表示でも可）
- 選択: クリックで切替（切替時はビュー状態リセット、注釈はドキュメントに紐づけて保持: `docs/multi-pdf-library-design.md`）
- アクション（右端メニュー）:
  - 開く / ダウンロード / ライブラリから削除
  - 同名対策: `name (2)` のように `displayName` を生成

### 14.4 ページ移動（Page Navigator）
配置: Command Bar 右側（常時表示）
- 表示: `current / total`（例: `12 / 120`）
- 入力: `Enter` でジャンプ、空/非数は復帰、範囲外はクランプ（詳細は `docs/page-jump-design.md`）
- スライダー: `input` で表示のみ、`change` でジャンプ（重さ回避）
- 追加（任意）: `p` キーで入力にフォーカス（作業速度が上がる）

### 14.5 検索（Search）
配置: Right Dock のタブ or Command Palette で即アクセス
- 主要導線: `Ctrl/Cmd + F` で検索UIを開き、入力にフォーカス
- 結果: ページ単位セクション + context 1行（長文はInspectorへ）
- ナビ: 次/前（`Enter`/`Shift+Enter`）をCommand Barに出しても良い

### 14.6 ハイライト（Marker）
要点: “作成・見つける・編集する”の3動線を分離する。
- 作成: 選択 → 右クリック → 「ハイライト」 + 色スウォッチ（現行を洗練）
- 一覧: Right Dock（Lists）
  - ページ単位セクション
  - 1行は「色 + ラベル（省略）」+ 右端に削除
- 編集: Right Dock（Inspector）
  - ラベル編集（短文）
  - 色変更（スウォッチ）
  - 削除（Destructive）

### 14.7 コメント（Comment）
基本は `docs/comment-uiux-redesign.md` を踏襲し、全体レイアウトに統合する。
- PDF上: 吹き出し内で返信完結（選択時のみ入力UI）
- 一覧: Right Dock（Lists）でページ単位セクション、高密度（削除 + タイトル）
- 詳細: Right Dock（Inspector）でスレッド全文/編集

### 14.8 OCR
配置: Right Dock（Inspector or 専用タブ）
- スコープ: ページ/全ページ
- 進捗: 「実行中」だけでなく、可能なら“どこまで処理中か”を見せる
- 結果: クリップボード/テキスト保存（現行を踏襲）

### 14.9 Compare（PDF比較）
配置: Right Dock（Compare）
- フロー: 対象PDF選択 → 実行 → 結果要約 → 変更ページへジャンプ
- 表示: Canvas 上は差分ハイライト、Dock側は「変更ページ」「メモ/注意点」
- モード表示: Command Bar に `Compare: ON` + 対象名（状態の見える化）

---

## 15. キーボードショートカット案（初期セット）
※衝突が出た場合は「OS標準」を優先し、代替キーを用意する。

- `Ctrl/Cmd + O`: PDFを追加（ファイルピッカー）
- `Ctrl/Cmd + F`: 検索を開く（入力フォーカス）
- `Ctrl/Cmd + K`: Command Palette（任意導入）
- `Ctrl/Cmd + [` / `Ctrl/Cmd + ]`: 前/次のPDF（ライブラリ切替）
- `PageUp` / `PageDown`: 前/次のページ
- `Ctrl/Cmd + G`（または `p`）: ページ入力にフォーカス
- `Ctrl/Cmd + Enter`: メッセージ送信（コメント/返信入力欄）
- `Esc`: メニュー/ダイアログを閉じる、選択解除（段階的に）
- `?`: ショートカット一覧を表示（Popover）

---

## 16. 手動QAチェック（デザイン更新で壊れやすい所）
- レスポンシブ: `>=1280`, `1024-1279`, `<1024` でDockが破綻しない
- キーボード: タブ移動/フォーカスリング/Enter操作が成立する
- 長文: ドキュメント名、検索結果、タイトル100文字でもレイアウトが崩れない
- 高密度: コメント100件以上でも一覧が重くならず視認できる
- 状態の見える化: Loading/Error/Mode（OCR/Compare/Objects）が常に理解できる
- 空状態: 次の一手が明確（PDF未選択、検索結果0件、OCR未実行、比較未設定）

---

## 17. 実装への落とし込み（設計→コード）
このドキュメントを「実装チケット」に分割する時の最小単位。

1) トークン整備（色以外の規律）
- `radius/space/shadow/z-index` を共通化（既存 `mixins` と整合）

2) レイアウト骨格
- Command Bar を “情報中心” に再配置（Doc名/Page/Zoom/Mode/Status）
- Left/Right Dock（タブ + 折りたたみ + 幅可変）を導入

3) 体験を上げる導線
- 「空状態 → PDF追加 → ページ移動 → 注釈追加」の最短導線を磨く
- ショートカット（15章）を実装して作業速度を上げる
