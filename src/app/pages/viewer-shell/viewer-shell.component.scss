@use '../../../styles/colors';
@use '../../../styles/mixins';
:host {
  @apply block min-h-screen overflow-hidden;
  background-color: mixins.color('bg-0');
  color: mixins.color('text-primary');
  @apply font-sans;
}

.viewer-shell {
  @apply mx-auto flex h-screen min-h-screen flex-col gap-4 px-4 py-4;
}

.viewer-shell__command-bar {
  @apply flex flex-col gap-2 border border-solid rounded-2xl px-4 py-3;
  min-height: 112px;
  position: relative;
  z-index: 40;
  background-image: radial-gradient(
      circle at 12% -30%,
      mixins.color('indigo-600-a35'),
      mixins.color('transparent') 50%
    ),
    linear-gradient(120deg, mixins.color('slate-850'), mixins.color('slate-900'));
  border-color: mixins.color('border-subtle');
  box-shadow: var(--shadow-2, 0 18px 40px mixins.color('black-a45'));
  @apply backdrop-blur-[16px];
}

.viewer-shell__command-row {
  @apply grid items-center gap-3 min-w-0;
}

.viewer-shell__command-row--primary {
  grid-template-columns: minmax(0, 1.3fr) minmax(0, 1fr) clamp(180px, 22vw, 260px) auto;
}

.viewer-shell__command-row--nav {
  @apply pt-2;
  grid-template-columns: minmax(0, 160px) minmax(0, 1fr) minmax(0, 160px);
  border-top: 1px solid mixins.color('border-subtle');
}

.viewer-shell__command-section {
  @apply flex min-w-0 items-center gap-2;
}

.viewer-shell__command-section--left {
  @apply justify-start;
}

.viewer-shell__command-section--right {
  @apply justify-end gap-3;
}

.viewer-shell__command-section--center {
  @apply flex flex-col items-center justify-center text-center;
}

.viewer-shell__command-section--status {
  @apply justify-end;
}

.viewer-shell__command-section--nav-left {
  @apply justify-start;
}

.viewer-shell__command-section--nav-center {
  @apply justify-center;
}

.viewer-shell__command-section--nav-right {
  @apply justify-end;
}

.viewer-shell__command-group {
  @apply flex items-center gap-2;
}

.viewer-shell__command-group--tight {
  @apply gap-1;
}


.viewer-shell__doc-title {
  @apply w-full;
}

.viewer-shell__doc-name {
  @apply block text-base font-semibold truncate;
  color: mixins.color('text-primary');
}

.viewer-shell__doc-name--empty {
  color: mixins.color('text-muted');
}

.viewer-shell__status-slot {
  @apply flex w-full min-w-0 items-center justify-end min-h-[32px];
}

.viewer-shell__status-group {
  @apply flex items-center gap-2 min-w-0 overflow-hidden;
}

.viewer-shell__file-picker {
  @apply inline-flex items-center gap-2 cursor-pointer;
}

.viewer-shell__file-picker:focus-within {
  @include mixins.focus-ring(mixins.color('blue-300'));
  border-color: mixins.color('border-strong');
}

.viewer-shell__file-picker-input {
  @apply hidden;
}

.viewer-shell__toolbar {
  @apply flex flex-1 flex-wrap items-center justify-between gap-2 px-4 py-2.5 border border-solid rounded-xl;
  @apply min-w-[320px];
  background-image: linear-gradient(120deg, mixins.color('slate-800-a95'), mixins.color('slate-900-a85'));
  border-color: mixins.color('slate-400-a25');
  box-shadow: 0 12px 26px mixins.color('slate-900-a70');
  @apply backdrop-blur-[8px];
}

.viewer-shell__toolbar-group {
  @apply flex flex-wrap items-center gap-2;
}

.viewer-shell__toolbar-group--page-jump {
  @apply flex-col items-stretch gap-1.5;
}

.viewer-shell__page-jump {
  @apply flex items-center gap-2;
}

.viewer-shell__page-prefix {
  @apply text-xs font-semibold uppercase;
  color: mixins.color('text-secondary');
}

.viewer-shell__page-input {
  @include mixins.field-base;
  @apply w-[72px] text-center text-sm font-semibold;
  background-color: mixins.color('surface-2');
  border-color: mixins.color('border-default');
  color: mixins.color('steel-100');
}

.viewer-shell__page-input:focus {
  @apply outline-none;
  border-color: mixins.color('border-strong');
  box-shadow: 0 0 0 1px mixins.color('blue-600-a35');
}

.viewer-shell__page-total {
  @apply text-xs font-semibold;
  color: mixins.color('text-secondary');
}

.viewer-shell__page-slider {
  @apply w-full cursor-pointer;
  accent-color: mixins.color('accent-1');
  @apply transition-[filter] duration-[140ms] ease-[ease];
}

.viewer-shell__page-slider:disabled {
  @apply cursor-not-allowed opacity-60;
}

.viewer-shell__page-slider:focus-visible {
  @include mixins.focus-ring(mixins.color('blue-300'));
}

.viewer-shell__page-slider:hover:not(:disabled) {
  filter: brightness(1.05);
}

.viewer-shell__page-slider::-webkit-slider-thumb {
  transition: transform 140ms ease, box-shadow 140ms ease;
}

.viewer-shell__page-slider::-moz-range-thumb {
  transition: transform 140ms ease, box-shadow 140ms ease;
}

.viewer-shell__page-slider:active::-webkit-slider-thumb {
  transform: scale(1.12);
}

.viewer-shell__page-slider:active::-moz-range-thumb {
  transform: scale(1.12);
}

.viewer-shell__zoom-indicator {
  @apply inline-flex items-center justify-center rounded-lg border border-solid px-2.5 py-1.5 font-bold;
  background-color: mixins.color('surface-2');
  border-color: mixins.color('border-subtle');
  color: mixins.color('steel-100');
}

.viewer-shell__button {
  @apply inline-flex items-center justify-center gap-2 px-3 py-2 text-sm font-semibold border border-solid cursor-pointer;
  min-height: 36px;
  border-radius: var(--radius-sm, 10px);
  border-color: mixins.color('border-default');
  background-image: linear-gradient(120deg, mixins.color('accent-1'), mixins.color('accent-2'));
  color: mixins.color('white');
  @apply transition-[border-color,box-shadow,background,color,transform] duration-[140ms] ease-[ease];
}

.viewer-shell__button:disabled {
  @apply cursor-not-allowed opacity-60;
}

.viewer-shell__button:focus-visible {
  @include mixins.focus-ring(mixins.color('blue-300'));
}

.viewer-shell__button:hover:not(:disabled) {
  box-shadow: 0 10px 20px mixins.color('black-a35');
  transform: translateY(-1px);
}

.viewer-shell__button--primary {
  box-shadow: 0 12px 24px mixins.color('black-a35');
}

.viewer-shell__button--ghost {
  background-color: mixins.color('transparent');
  border-color: mixins.color('border-subtle');
  color: mixins.color('text-secondary');
}

.viewer-shell__button--ghost:hover:not(:disabled) {
  background-color: mixins.color('surface-2');
  border-color: mixins.color('border-default');
  color: mixins.color('text-primary');
  box-shadow: none;
  transform: none;
}

.viewer-shell__button--active {
  background-color: mixins.color('blue-600-a16');
  border-color: mixins.color('border-strong');
  color: mixins.color('blue-200');
}

.viewer-shell__button--small {
  @apply px-2.5 py-1 rounded-full text-[11px];
}

.viewer-shell__button--compact {
  @apply px-1.5 py-0.5 rounded-md text-[11px];
}

.viewer-shell__button--danger {
  color: mixins.color('red-400');
  border-color: mixins.color('red-400-a40');
}

.viewer-shell__button--menu {
  @apply w-full justify-start;
}

.viewer-shell__tools-menu {
  @apply relative;
}

.viewer-shell__tools-menu-popover {
  @apply absolute flex flex-col gap-1.5 rounded-xl border border-solid p-2 min-w-[180px] z-20;
  top: calc(100% + 8px);
  left: 0;
  background-color: mixins.color('surface-3');
  border-color: mixins.color('border-subtle');
  box-shadow: 0 12px 28px mixins.color('black-a45');
}

.viewer-shell__tools-menu-item {
  @apply w-full justify-start;
}

.viewer-shell__tools-menu-item--responsive {
  @apply hidden;
}

.viewer-shell__status {
  @apply flex flex-col gap-2;
}

.viewer-shell__status-document {
  @apply flex flex-col gap-1;
}

.viewer-shell__status-label {
  @apply text-[11px] tracking-[0.12em] uppercase;
  color: mixins.color('slate-400-a80');
}

.viewer-shell__status-name {
  @apply text-[15px] font-semibold;
  color: mixins.color('steel-100');
}

.viewer-shell__status-meta {
  @apply mt-2 flex flex-wrap gap-2.5;
}

.viewer-shell__status-pill {
  @apply inline-flex items-center gap-1.5 rounded-full px-3 py-1.5 text-xs font-semibold border border-solid truncate;
  max-width: clamp(140px, 18vw, 220px);
  color: mixins.color('text-primary');
  background-color: mixins.color('surface-3');
  border-color: mixins.color('border-subtle');
  box-shadow: inset 0 0 8px mixins.color('slate-900-a80');
}

.viewer-shell__status-pill--accent {
  color: mixins.color('blue-200');
  background-color: mixins.color('blue-600-a16');
  border-color: mixins.color('border-strong');
}

.viewer-shell__status-pill--muted {
  color: mixins.color('text-muted');
  background-color: mixins.color('surface-2');
  border-color: mixins.color('border-subtle');
}

.viewer-shell__status-pill--info {
  color: mixins.color('blue-200');
  background-color: mixins.color('slate-900-a70');
  border-color: mixins.color('blue-600-a35');
}

.viewer-shell__status-pill--loading {
  color: mixins.color('amber-200');
  border-color: mixins.color('amber-400-a40');
  background-color: mixins.color('amber-400-a18');
}

.viewer-shell__status-pill--loading::before {
  @apply content-[''];
  @apply h-2 w-2 rounded-full;
  background-color: mixins.color('amber-400');
  @apply animate-[viewerShellPulse_1.2s_ease-in-out_infinite];
}

.viewer-shell__status-pill--error {
  color: mixins.color('red-200');
  border-color: mixins.color('red-400-a70');
  background-color: mixins.color('red-400-a20');
}

@keyframes viewerShellPulse {
  0% {
    transform: scale(0.9);
    opacity: 0.6;
  }
  50% {
    transform: scale(1.1);
    opacity: 1;
  }
  100% {
    transform: scale(0.9);
    opacity: 0.6;
  }
}

@keyframes viewerShellShimmer {
  0% {
    background-position: 100% 50%;
  }
  100% {
    background-position: 0% 50%;
  }
}

.viewer-shell__layout {
  @apply relative grid flex-1 min-h-0 gap-3;
  grid-template-columns: auto minmax(0, 1fr) auto;
  grid-template-rows: minmax(0, 1fr);
}

.viewer-shell__viewer {
  @apply relative flex h-full w-full min-h-0 min-w-0 flex-col overflow-hidden p-[clamp(8px,1.2vw,16px)];
  @include mixins.surface(mixins.color('surface-1'), mixins.color('border-subtle'), 16px);
  box-shadow: var(--shadow-1, 0 10px 24px mixins.color('black-a35'));
}

.viewer-shell__dock {
  @apply relative flex min-h-0 flex-col overflow-hidden;
  @include mixins.surface(mixins.color('surface-2'), mixins.color('border-subtle'), 18px);
  box-shadow: var(--shadow-1, 0 12px 28px mixins.color('black-a40'));
  @apply transition-[transform,width] duration-[180ms] ease-[ease];
}

.viewer-shell__dock--left {
  width: var(--left-dock-width, 320px);
}

.viewer-shell__dock--right {
  width: var(--right-dock-width, 320px);
}

.viewer-shell__dock--collapsed {
  width: var(--dock-collapsed-width, 56px);
}

.viewer-shell__dock--collapsed .viewer-shell__dock-body {
  @apply hidden;
}

.viewer-shell__dock--collapsed .viewer-shell__dock-header {
  @apply flex-col items-center gap-2;
}

.viewer-shell__dock--collapsed .viewer-shell__dock-tabs {
  @apply flex-col items-stretch;
}

.viewer-shell__dock--collapsed .viewer-shell__dock-tab {
  @apply px-2 text-[10px];
}

.viewer-shell__dock--collapsed .viewer-shell__dock-tab-label {
  @apply hidden;
}

.viewer-shell__dock--collapsed .viewer-shell__dock-tab-short {
  @apply inline-flex;
}

.viewer-shell__dock--collapsed .viewer-shell__dock-resizer {
  @apply hidden;
}

.viewer-shell__dock-header {
  @apply flex items-center justify-between gap-2 border-b border-solid px-3 py-2;
  border-color: mixins.color('border-subtle');
  background-color: mixins.color('surface-3');
}

.viewer-shell__dock-tabs {
  @apply flex flex-wrap items-center gap-2 min-w-0;
}

.viewer-shell__dock-tab {
  @apply inline-flex items-center justify-center px-2.5 text-xs font-semibold border border-solid;
  min-height: 36px;
  border-radius: var(--radius-sm, 10px);
  border-color: mixins.color('border-subtle');
  color: mixins.color('text-secondary');
  background-color: mixins.color('surface-2');
  @apply transition-[border-color,background,color] duration-[140ms] ease-[ease];
}

.viewer-shell__dock-tab:focus-visible {
  @include mixins.focus-ring(mixins.color('blue-300'));
}

.viewer-shell__dock-tab-label {
  @apply inline-flex;
}

.viewer-shell__dock-tab-short {
  @apply hidden text-[10px] font-bold tracking-[0.08em];
}

.viewer-shell__dock-tab--active {
  border-color: mixins.color('border-strong');
  background-color: mixins.color('surface-1');
  color: mixins.color('text-primary');
  box-shadow: 0 0 0 1px mixins.color('blue-600-a35');
}

.viewer-shell__dock-body {
  @apply flex min-h-0 flex-1 flex-col gap-3 overflow-y-auto px-3 py-3;
}

.viewer-shell__dock-resizer {
  @apply absolute top-0 bottom-0 right-0 w-1 cursor-col-resize;
  background-color: transparent;
}

.viewer-shell__dock-resizer::after {
  @apply content-[''] absolute top-2 bottom-2 left-1/2 w-[2px] -translate-x-1/2;
  background-color: mixins.color('border-subtle');
  opacity: 0.4;
}

.viewer-shell__dock-resizer:hover::after {
  opacity: 0.8;
}

.viewer-shell__dock-resizer--right {
  @apply left-0 right-auto;
}

.viewer-shell__icon-button {
  @apply inline-flex items-center justify-center rounded-lg border border-solid text-xs font-bold;
  width: 36px;
  height: 36px;
  border-color: mixins.color('border-subtle');
  background-color: mixins.color('surface-2');
  color: mixins.color('text-secondary');
  @apply transition-[border-color,background,color] duration-[140ms] ease-[ease];
}

.viewer-shell__icon-button:focus-visible {
  @include mixins.focus-ring(mixins.color('blue-300'));
}

.viewer-shell__icon-button:hover {
  border-color: mixins.color('border-default');
  background-color: mixins.color('surface-1');
  color: mixins.color('text-primary');
}

.viewer-shell__drag-overlay {
  @apply absolute inset-0 z-[15] flex items-center justify-center pointer-events-none;
  border: 2px dashed mixins.color('border-strong');
  background-color: mixins.color('blue-600-a16');
  border-radius: 14px;
  box-shadow: inset 0 0 0 1px mixins.color('blue-500-a35');
}

.viewer-shell__drag-overlay-content {
  @apply rounded-xl border border-solid px-4 py-3 text-sm font-semibold;
  border-color: mixins.color('blue-400-a60');
  background-color: mixins.color('ink-900-a90');
  color: mixins.color('blue-200');
  box-shadow: 0 12px 24px mixins.color('black-a40');
}

.viewer-shell__viewer-grid {
  @apply grid flex-1 min-h-0 min-w-0 gap-4 overflow-hidden grid-cols-1 items-stretch overscroll-contain;
}

.viewer-shell__viewer-grid--compare {
  @apply grid-cols-2;
}

.viewer-shell__viewer-pane {
  @apply flex min-h-0 min-w-0 flex-col;
}

.viewer-shell__viewer-pane-label {
  @apply mb-2 text-xs font-bold tracking-[0.08em] uppercase;
  color: mixins.color('blue-300');
}

.viewer-shell__viewer-hint {
  @apply flex flex-wrap gap-3 border border-dashed rounded-[10px] px-3 py-2 text-[13px];
  background-color: mixins.color('surface-2');
  border-color: mixins.color('border-subtle');
  color: mixins.color('steel-300');
}

.viewer-shell__empty-state {
  @apply py-6 text-center text-sm;
  color: mixins.color('text-muted');
}

.viewer-shell__empty-state--dock {
  @apply py-4 text-xs;
}

.viewer-shell__empty-state--panel {
  @apply rounded-xl border border-dashed px-3 py-4 text-xs;
  border-color: mixins.color('border-subtle');
  background-color: mixins.color('surface-2');
}

.viewer-shell__pages {
  @apply relative mt-3 flex-1 min-h-0;
}

.viewer-shell__pdf-viewer-host {
  @apply relative z-[1] h-full min-h-0 overflow-auto overscroll-contain;
}

.viewer-shell__pdf-pages {
  @apply flex flex-col items-center gap-[18px] py-3;
}

.viewer-shell__pdf-page {
  @apply relative overflow-hidden rounded-[10px] border border-solid;
  background-color: mixins.color('gray-900');
  border-color: mixins.color('gray-800');
  box-shadow: 0 10px 25px mixins.color('black-a35');
}

.viewer-shell__pdf-canvas {
  @apply block max-w-full;
}

.viewer-shell__text-layer {
  @apply absolute inset-0 select-text overflow-hidden;
  color: transparent;
  line-height: 1;
  transform-origin: 0 0;
}

.viewer-shell__text-layer span {
  @apply absolute whitespace-pre;
  transform-origin: 0% 0%;
  cursor: text;
  line-height: 1;
}

.viewer-shell__text-layer ::selection {
  background-color: mixins.color('blue-500-a45');
}

.viewer-shell__text-layer .text-highlight {
  @apply rounded-sm box-decoration-clone;
}

.viewer-shell__page-overlays {
  @apply absolute inset-0 pointer-events-none z-[4];
  transform: translate(
    calc(-1 * var(--pdf-scroll-left, 0px)),
    calc(-1 * var(--pdf-scroll-top, 0px))
  );
}

.viewer-shell__page-overlay {
  @apply absolute box-border pointer-events-none;
  @include mixins.rect-vars(--overlay-left, --overlay-top, --overlay-width, --overlay-height);
}

.viewer-shell__page-overlay--changed {
  @apply rounded-[10px] border border-solid;
  border-color: mixins.color('amber-400-a70');
  box-shadow: 0 0 0 1px mixins.color('amber-400-a25'), 0 10px 25px mixins.color('black-a35');
}

.viewer-shell__page-overlay--changed .viewer-shell__page-label {
  border-color: mixins.color('amber-400-a60');
  color: mixins.color('amber-100');
  background-color: mixins.color('amber-700-a35');
}

.viewer-shell__diff-highlight {
  @apply absolute pointer-events-none z-[2] mix-blend-multiply border border-solid rounded;
  @include mixins.rect-vars(--diff-left, --diff-top, --diff-width, --diff-height, 0%);
  border-color: mixins.color('red-400-a65');
  background-color: mixins.color('red-400-a25');
}

.viewer-shell__page-highlight {
  @apply absolute rounded-md pointer-events-auto z-[2] cursor-pointer select-none;
  @include mixins.rect-vars(--marker-left, --marker-top, --marker-width, --marker-height, 0%);
  background-color: transparent;
  @apply transition-[opacity,box-shadow,transform] duration-[120ms] ease-[ease];
}

.viewer-shell__page-highlight::before {
  content: '';
  @apply absolute inset-x-0 pointer-events-none mix-blend-multiply opacity-[0.65];
  --marker-trim-y: clamp(1px, 18%, 6px);
  top: var(--marker-trim-y);
  bottom: var(--marker-trim-y);
  @apply border border-solid rounded-md;
  border-color: var(--marker-color, mixins.color('transparent'));
  background-color: var(--marker-color, mixins.color('highlight-default'));
}

.viewer-shell__page-highlight--selected {
  @apply transform-gpu;
}

.viewer-shell__page-highlight--selected::before {
  @apply opacity-90 mix-blend-normal;
  border-color: var(--highlight-strong, mixins.color('white-a75'));
  box-shadow: 0 0 0 1px var(--highlight-strong, mixins.color('white-a60')),
    0 6px 20px mixins.color('black-a35');
}

.viewer-shell__page-highlight-label {
  @apply absolute rounded-md px-1.5 py-1 border border-solid font-bold;
  @include mixins.point-vars(--label-left, --label-top, 0%);
  @apply -translate-x-1/2 translate-y-[-120%];
  @apply text-[11px];
  color: mixins.color('ink-900');
  border-color: var(--label-color, mixins.color('transparent'));
  background-color: var(--label-color, mixins.color('highlight-default'));
  box-shadow: 0 4px 12px mixins.color('black-a35');
  @apply pointer-events-auto z-[3] cursor-pointer select-none;
}

.viewer-shell__page-highlight-label--selected {
  @apply opacity-95;
  box-shadow: 0 0 0 1px var(--highlight-strong, mixins.color('white-a50')),
    0 8px 20px mixins.color('black-a40');
}

.viewer-shell__page-label {
  @apply absolute right-2.5 top-2.5 rounded-lg border border-solid px-2 py-1 text-xs z-[4];
  background-color: mixins.color('slate-900-a85');
  border-color: mixins.color('gray-800');
  color: mixins.color('steel-100');
}

.viewer-shell__side-panel {
  @apply flex h-full min-h-0 flex-col gap-3 overflow-y-auto;
}

.viewer-shell__panel {
  @apply p-3;
  @include mixins.surface(mixins.color('surface-1'), mixins.color('border-subtle'), 14px);
  box-shadow: var(--shadow-1, 0 12px 28px mixins.color('black-a35'));
}

.viewer-shell__panel-header {
  @apply mb-2 flex items-center justify-between gap-2;
}

.viewer-shell__panel-title {
  @apply m-0;
  @apply text-[15px];
  color: mixins.color('text-primary');
}

.viewer-shell__panel-body {
  @apply flex flex-col gap-2;
}

.viewer-shell__panel--inspector {
  @apply min-h-[180px];
}

.viewer-shell__field {
  @apply flex flex-col gap-1;
}

.viewer-shell__field-label {
  @apply text-[11px] font-semibold tracking-[0.08em] uppercase;
  color: mixins.color('text-muted');
}

.viewer-shell__field-inline {
  @apply flex items-center justify-between gap-2;
}

.viewer-shell__field-value {
  @apply text-sm font-semibold truncate;
  color: mixins.color('text-primary');
}

.viewer-shell__swatch-row {
  @apply flex flex-wrap gap-1.5;
}

.viewer-shell__inspector-block {
  @apply flex flex-col gap-2;
}

.viewer-shell__inspector-header {
  @apply flex items-center justify-between gap-2 text-xs font-semibold;
  color: mixins.color('steel-200');
}

.viewer-shell__inspector-type {
  @apply rounded-full px-2 py-1 text-[11px];
  background-color: mixins.color('surface-2');
  border: 1px solid mixins.color('border-subtle');
}

.viewer-shell__inspector-meta {
  @apply text-[11px] font-semibold;
  color: mixins.color('text-muted');
}

.viewer-shell__inspector-meta-row {
  @apply flex items-center justify-between text-[11px];
  color: mixins.color('text-muted');
}

.viewer-shell__inspector-actions {
  @apply flex items-center justify-end gap-2;
}

.viewer-shell__inspector-preview {
  @apply text-xs leading-[1.4] break-words;
}

.viewer-shell__form-row {
  @apply flex flex-wrap items-center gap-2;
}

.viewer-shell__ocr-setup {
  @apply flex flex-col gap-2;
}

.viewer-shell__ocr-controls {
  @apply flex flex-wrap items-end gap-2;
}

.viewer-shell__ocr-field {
  @apply flex flex-col gap-1 min-w-0;
  flex: 1 1 180px;
}

.viewer-shell__ocr-field--page {
  flex: 0 1 110px;
}

.viewer-shell__ocr-label {
  @apply text-xs font-semibold;
  color: mixins.color('text-secondary');
}

.viewer-shell__ocr-run {
  @apply whitespace-nowrap;
}

.viewer-shell__ocr-hint {
  @apply leading-[1.4];
}

.viewer-shell__input,
.viewer-shell__select,
.viewer-shell__textarea {
  @include mixins.field-base;
}

.viewer-shell__input:focus,
.viewer-shell__select:focus,
.viewer-shell__textarea:focus {
  @apply outline-none;
  border-color: mixins.color('border-strong');
  box-shadow: 0 0 0 1px mixins.color('blue-600-a35');
}

.viewer-shell__input--grow,
.viewer-shell__select--grow {
  @apply flex-1 min-w-0;
  @apply w-auto;
}

.viewer-shell__textarea {
  @apply min-h-12 max-h-[140px] resize-y;
}

.viewer-shell__card {
  @apply p-2.5;
  @include mixins.surface(mixins.color('surface-2'), mixins.color('border-subtle'), 10px);
}

.viewer-shell__card-row {
  @apply flex items-center justify-between gap-2;
}

.viewer-shell__tag {
  @apply rounded-lg px-2 py-1 text-xs;
  background-color: mixins.color('slate-800');
  color: mixins.color('steel-200');
}

.viewer-shell__badge {
  @apply rounded-xl px-2 py-1 text-xs font-bold;
  background-color: mixins.color('blue-900');
  color: mixins.color('white');
}

.viewer-shell__helper-text {
  @apply text-xs;
  color: mixins.color('text-muted');
}

.viewer-shell__link {
  @apply no-underline;
  color: mixins.color('accent-1');
}

.viewer-shell__link:hover {
  @apply underline;
}

.viewer-shell__link:focus-visible {
  @include mixins.focus-ring(mixins.color('blue-300'));
}

.viewer-shell__context-menu {
  @include mixins.point-vars(--context-menu-left, --context-menu-top, 0px);
  @apply fixed flex flex-col gap-2 border border-solid rounded-xl p-2.5 min-w-[220px] z-20;
  background-color: mixins.color('surface-3');
  border-color: mixins.color('border-subtle');
  box-shadow: 0 12px 28px mixins.color('black-a45');
}

.viewer-shell__library-list {
  @apply flex flex-col gap-2;
}

.viewer-shell__library-item {
  @apply grid items-center gap-3 rounded-xl border border-solid p-2 text-left cursor-pointer;
  grid-template-columns: 56px minmax(0, 1fr);
  border-color: mixins.color('border-subtle');
  background-color: mixins.color('surface-2');
  @apply transition-[border-color,box-shadow,transform] duration-[160ms] ease-[ease];
}

.viewer-shell__library-item:hover {
  border-color: mixins.color('border-default');
  box-shadow: 0 16px 24px mixins.color('black-a35');
  transform: translateY(-1px);
}

.viewer-shell__library-item:focus-visible {
  @include mixins.focus-ring(mixins.color('blue-300'));
}

.viewer-shell__library-item--selected {
  border-color: mixins.color('border-strong');
  box-shadow: 0 0 0 1px mixins.color('blue-600-a35'), 0 16px 28px mixins.color('black-a40');
}

.viewer-shell__thumbnail-list {
  @apply grid gap-2;
  grid-template-columns: repeat(auto-fill, minmax(96px, 1fr));
}

.viewer-shell__thumbnail-item {
  @apply flex flex-col items-center gap-2 rounded-xl border border-solid p-2 text-left cursor-pointer;
  border-color: mixins.color('border-subtle');
  background-color: mixins.color('surface-2');
  @apply transition-[border-color,box-shadow,transform] duration-[160ms] ease-[ease];
}

.viewer-shell__thumbnail-item:hover {
  border-color: mixins.color('border-default');
  box-shadow: 0 12px 22px mixins.color('black-a35');
  transform: translateY(-1px);
}

.viewer-shell__thumbnail-item:focus-visible {
  @include mixins.focus-ring(mixins.color('blue-300'));
}

.viewer-shell__thumbnail-item--selected {
  border-color: mixins.color('border-strong');
  box-shadow: 0 0 0 1px mixins.color('blue-600-a35'), 0 12px 22px mixins.color('black-a35');
}

.viewer-shell__thumbnail-frame {
  @apply relative flex w-full items-center justify-center overflow-hidden rounded-lg border border-solid;
  border-color: mixins.color('border-subtle');
  background-image: linear-gradient(180deg, mixins.color('surface-3'), mixins.color('surface-2'));
  aspect-ratio: 3 / 4;
}

.viewer-shell__thumbnail-label {
  @apply text-xs font-semibold;
  color: mixins.color('text-secondary');
}

.viewer-shell__library-overlay {
  @apply fixed inset-0 z-30 flex items-center justify-center p-6;
  background-color: mixins.color('black-a60');
  backdrop-filter: blur(6px);
}

.viewer-shell__library-dialog {
  @apply w-full max-w-[980px] max-h-[82vh] overflow-hidden border border-solid rounded-2xl;
  @apply flex flex-col;
  background-image: linear-gradient(140deg, mixins.color('slate-900'), mixins.color('ink-900'));
  border-color: mixins.color('slate-400-a40');
  box-shadow: 0 35px 70px mixins.color('black-a55');
}

.viewer-shell__library-header {
  @apply flex items-center justify-between gap-4 px-5 py-4 border-b border-solid;
  border-color: mixins.color('slate-400-a25');
  background-color: mixins.color('slate-900-a70');
}

.viewer-shell__library-heading {
  @apply flex items-baseline gap-3;
}

.viewer-shell__library-title {
  @apply m-0 text-lg font-bold;
  color: mixins.color('steel-100');
}

.viewer-shell__library-count {
  @apply text-xs font-semibold;
  color: mixins.color('steel-300');
}

.viewer-shell__library-content {
  @apply flex-1 overflow-auto;
}

.viewer-shell__library-grid {
  @apply grid gap-4 p-5;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
}

.viewer-shell__library-card {
  @apply flex flex-col gap-2 rounded-xl border border-solid p-3 text-left cursor-pointer;
  background-color: mixins.color('slate-900-a70');
  border-color: mixins.color('slate-400-a25');
  @apply transition-[border-color,box-shadow,transform] duration-[160ms] ease-[ease];
}

.viewer-shell__library-card:hover {
  border-color: mixins.color('blue-400-a60');
  box-shadow: 0 18px 28px mixins.color('black-a45');
  transform: translateY(-2px);
}

.viewer-shell__library-card--selected {
  border-color: mixins.color('blue-400');
  box-shadow: 0 0 0 1px mixins.color('blue-400-a45'), 0 18px 32px mixins.color('black-a45');
}

.viewer-shell__library-card:focus-visible {
  @include mixins.focus-ring(mixins.color('blue-300'));
}

.viewer-shell__library-thumb {
  @apply relative w-full overflow-hidden rounded-lg border border-solid;
  aspect-ratio: 3 / 4;
  background-color: mixins.color('surface-3');
  border-color: mixins.color('border-subtle');
}

.viewer-shell__library-thumb img {
  @apply h-full w-full object-cover;
}

.viewer-shell__library-thumb-skeleton {
  @apply absolute inset-0;
  background-image: linear-gradient(
    100deg,
    mixins.color('surface-2'),
    mixins.color('surface-3'),
    mixins.color('surface-2')
  );
  background-size: 200% 100%;
  animation: viewerShellShimmer 1.2s ease-in-out infinite;
}

.viewer-shell__library-thumb-placeholder {
  @apply flex h-full w-full items-center justify-center text-sm font-semibold;
  color: mixins.color('text-secondary');
  background-color: mixins.color('surface-2');
}

.viewer-shell__library-meta {
  @apply flex flex-col gap-1 min-w-0;
}

.viewer-shell__library-name {
  @apply text-sm font-semibold;
  color: mixins.color('text-primary');
  @include mixins.text-ellipsis;
}

.viewer-shell__library-pages {
  @apply text-xs font-semibold;
  color: mixins.color('text-muted');
}

.viewer-shell__highlight-swatches {
  @apply flex flex-wrap gap-1.5;
}

.viewer-shell__highlight-swatch {
  @apply inline-flex items-center justify-center h-[22px] w-[22px] rounded-md border border-solid p-0;
  border-color: mixins.color('slate-400-a60');
  background-color: var(--swatch-color, mixins.color('transparent'));
  box-shadow: inset 0 0 0 1px mixins.color('slate-900-a60');
}

.viewer-shell__context-menu .viewer-shell__highlight-swatch {
  @apply min-w-[22px];
}

.viewer-shell__highlight-swatch--selected {
  border-color: mixins.color('slate-50');
  box-shadow: 0 0 0 1px mixins.color('slate-50-a45');
}

.viewer-shell__highlight-swatch:focus-visible {
  @include mixins.focus-ring(mixins.color('blue-300'));
}

.viewer-shell__selection-preview {
  @apply m-0 max-w-[280px] max-h-[80px] truncate;
}

.viewer-shell__search-list {
  @apply flex flex-col gap-2;
}

.viewer-shell__search-section {
  @include mixins.list-section;
}

.viewer-shell__search-section:first-child {
  @include mixins.list-section-first;
}

.viewer-shell__search-section-header {
  @include mixins.list-section-header;
}

.viewer-shell__search-section-label {
  color: mixins.color('slate-200');
}

.viewer-shell__search-section-count {
  @include mixins.list-count(
    mixins.color('blue-800-a35'),
    mixins.color('blue-500-a35'),
    mixins.color('blue-200')
  );
}

.viewer-shell__search-items {
  @apply mt-1 flex flex-col gap-1;
}

.viewer-shell__search-item {
  @include mixins.list-item-base;
  @apply no-underline;
}

.viewer-shell__search-item:hover {
  border-color: mixins.color('slate-400-a35');
  background-color: mixins.color('slate-900-a80');
}

.viewer-shell__search-item:focus-visible {
  @include mixins.focus-ring(mixins.color('blue-300'));
}

.viewer-shell__search-item-context {
  @apply flex-1 min-w-0 text-xs font-medium;
  @include mixins.text-ellipsis;
  color: mixins.color('text-primary');
}

.viewer-shell__highlight-list {
  @apply flex flex-col gap-2;
}

.viewer-shell__highlight-section {
  @include mixins.list-section;
}

.viewer-shell__highlight-section:first-child {
  @include mixins.list-section-first;
}

.viewer-shell__highlight-section-header {
  @include mixins.list-section-header;
}

.viewer-shell__highlight-section-label {
  color: mixins.color('slate-200');
}

.viewer-shell__highlight-section-count {
  @include mixins.list-count(
    mixins.color('yellow-500-a20'),
    mixins.color('yellow-400-a35'),
    mixins.color('yellow-200')
  );
}

.viewer-shell__highlight-items {
  @apply mt-1 flex flex-col gap-1;
}

.viewer-shell__highlight-item {
  @include mixins.list-item-base;
}

.viewer-shell__highlight-item:hover {
  border-color: mixins.color('slate-400-a35');
  background-color: mixins.color('slate-900-a80');
}

.viewer-shell__highlight-item:focus-visible {
  @include mixins.focus-ring(mixins.color('yellow-400'));
}

.viewer-shell__highlight-item--selected {
  border-color: mixins.color('yellow-500-a60');
  box-shadow: 0 0 0 1px mixins.color('yellow-500-a35');
  background-image: linear-gradient(180deg, mixins.color('warm-900-a90'), mixins.color('slate-900-a85'));
}

.viewer-shell__highlight-item-swatch {
  @apply h-3 w-3 rounded border border-solid shrink-0;
  border-color: mixins.color('slate-400-a50');
  background-color: var(--swatch-color, mixins.color('highlight-default'));
  box-shadow: 0 0 0 1px mixins.color('slate-900-a60');
}

.viewer-shell__highlight-item-title {
  @include mixins.list-item-title;
}

.viewer-shell__highlight-item-delete {
  @apply ml-auto shrink-0;
}

.viewer-shell__compare-pages {
  @apply flex flex-col gap-2;
}

.viewer-shell__page-chips {
  @apply flex flex-wrap gap-1.5;
}

.viewer-shell__card pre {
  @apply whitespace-pre-wrap text-xs;
  color: mixins.color('text-secondary');
}

@media (max-width: 1400px) {
  .viewer-shell__viewer-grid--compare {
    @apply grid-cols-1;
  }

  .viewer-shell__command-row--primary {
    grid-template-columns: minmax(0, 1fr) auto;
  }

  .viewer-shell__command-section--left {
    grid-column: 1;
    grid-row: 1;
  }

  .viewer-shell__command-section--right {
    grid-column: 2;
    grid-row: 1;
  }

  .viewer-shell__command-section--center {
    grid-column: 1;
    grid-row: 2;
    @apply items-start text-left;
  }

  .viewer-shell__command-section--status {
    grid-column: 2;
    grid-row: 2;
  }

  .viewer-shell__command-section--left,
  .viewer-shell__command-section--right {
    @apply flex-wrap;
  }

  .viewer-shell__command-bar .viewer-shell__button {
    @apply whitespace-nowrap;
  }
}

@media (max-width: 1279px) {
  .viewer-shell__layout {
    grid-template-columns: minmax(0, 1fr);
  }

  .viewer-shell__dock--right {
    @apply absolute top-0 right-0 bottom-0;
    width: min(var(--right-dock-width, 320px), 88vw);
    transform: translateX(100%);
    z-index: 20;
  }

  .viewer-shell__dock--right.viewer-shell__dock--expanded {
    transform: translateX(0);
  }

  .viewer-shell__dock--right.viewer-shell__dock--collapsed {
    transform: translateX(100%);
  }

  .viewer-shell__dock-resizer {
    @apply hidden;
  }
}

@media (max-width: 1023px) {
  .viewer-shell__command-bar {
    @apply gap-2;
  }

  .viewer-shell__command-section--center {
    grid-column: 1 / -1;
    grid-row: 2;
  }

  .viewer-shell__command-section--status {
    grid-column: 1 / -1;
    grid-row: 3;
    @apply justify-start;
  }

  .viewer-shell__command-row--nav {
    grid-template-columns: minmax(0, 140px) minmax(0, 1fr) minmax(0, 80px);
  }

  .viewer-shell__command-search {
    @apply hidden;
  }

  .viewer-shell__tools-menu-item--responsive {
    @apply inline-flex;
  }

  .viewer-shell__zoom-reset {
    @apply hidden;
  }

  .viewer-shell__dock--left {
    @apply absolute top-0 left-0 bottom-0;
    width: min(var(--left-dock-width, 320px), 88vw);
    transform: translateX(-100%);
    z-index: 20;
  }

  .viewer-shell__dock--left.viewer-shell__dock--expanded {
    transform: translateX(0);
  }

  .viewer-shell__dock--left.viewer-shell__dock--collapsed {
    transform: translateX(-100%);
  }
}
